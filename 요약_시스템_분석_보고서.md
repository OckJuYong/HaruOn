# ğŸ“Š ìš”ì•½ ì‹œìŠ¤í…œ ìµœì í™” ë¶„ì„ ë³´ê³ ì„œ

## í˜„ì¬ ìƒí™©

### ìš”êµ¬ì‚¬í•­
1. **100ì ìš”ì•½** (ì‚¬ìš©ì í‘œì‹œìš©)
   - ì‚¬ìš©ìì—ê²Œ ë³´ì„
   - ê·¸ë¦¼ì¼ê¸°ì— í‘œì‹œ
   - ë””í…Œì¼í•œ ë‚´ìš© í¬í•¨

2. **30ì ìš”ì•½** (ì¥ê¸° ê¸°ì–µìš©)
   - ì„œë²„ ì €ì¥
   - ì‚¬ìš©ì ì •ë³´ ê¸°ì–µ ëª©ì 
   - ì´í›„ ëŒ€í™”ì—ì„œ ë§¥ë½ ì œê³µ

### í˜„ì¬ êµ¬í˜„ (line 822-972)
```javascript
const summaryPrompt = `ë‚´ê°€ ì˜¤ëŠ˜ ë‚˜ëˆˆ ëŒ€í™”ë¥¼ ë‚˜ì˜ ê´€ì ì—ì„œ 3-4ì¤„ë¡œ ìš”ì•½í•´ì¤˜.
ìš”ì•½ ê·œì¹™:
1. "ë‚˜ëŠ” ~í–ˆë‹¤", "ë‚´ê°€ ~ì— ëŒ€í•´ ì´ì•¼ê¸°í–ˆë‹¤" í˜•ì‹ìœ¼ë¡œ 1ì¸ì¹­ ê´€ì ì—ì„œ ì‘ì„±
2. ë‚˜ì˜ ê²½í—˜, ê°ì •, ìƒê°, ê³ ë¯¼ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì„œìˆ 
3. ì¼ê¸°ì²´ì²˜ëŸ¼ ìì—°ìŠ¤ëŸ½ê³  ì†”ì§í•˜ê²Œ
4. ì™„ì „í•œ ë¬¸ì¥ìœ¼ë¡œ ë§ˆë¬´ë¦¬ (ì¤‘ê°„ì— ëŠê¸°ì§€ ì•Šê²Œ)
5. 200ì ì´ë‚´ì—ì„œ ì™„ì„±ëœ ë‚´ìš©ìœ¼ë¡œ
6. ë¶€ì •ì  ê°ì •ë„ ìˆëŠ” ê·¸ëŒ€ë¡œ í‘œí˜„ (ê³¼ë„í•œ ê¸ì •í™” ê¸ˆì§€)
`;
```

**ë¬¸ì œì **:
- âŒ 100ì/30ì 2ë‹¨ê³„ ìš”ì•½ì´ ì—†ìŒ
- âŒ ì‚¬ìš©ì ë°œì–¸ ì¤‘ì‹¬ì´ ì•„ë‹Œ ì „ì²´ ëŒ€í™” ìš”ì•½
- âŒ AI ì‘ë‹µë„ ìš”ì•½ì— í¬í•¨ë¨

---

## ğŸ’¡ ìµœì í™” ë°©ì•ˆ

### ì˜µì…˜ 1: AI ê¸°ë°˜ 2ë‹¨ê³„ ìš”ì•½ (í˜„ì¬ ì ‘ê·¼ ë°©ì‹ ê°œì„ )
**ì¥ì **:
- âœ… êµ¬í˜„ ê°„ë‹¨
- âœ… ì¶”ê°€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆí•„ìš”
- âœ… ì‚¬ìš©ì ê°ì •/ë§¥ë½ ì´í•´ ê°€ëŠ¥

**ë‹¨ì **:
- âŒ API í˜¸ì¶œ 2íšŒ í•„ìš” (ë¹„ìš©)
- âŒ ì²˜ë¦¬ ì‹œê°„ ì¦ê°€

**êµ¬í˜„ ë°©ë²•**:
```javascript
// 1ë‹¨ê³„: 100ì ì‚¬ìš©ì ì¤‘ì‹¬ ìš”ì•½
const detailedSummary = AIìš”ì•½("ì‚¬ìš©ì ë°œì–¸ë§Œ", "100ì");

// 2ë‹¨ê³„: 30ì í•µì‹¬ ìš”ì•½
const compactSummary = AIìš”ì•½(detailedSummary, "30ì");
```

---

### ì˜µì…˜ 2: í…ìŠ¤íŠ¸ ì••ì¶• ì•Œê³ ë¦¬ì¦˜ í™œìš©
**ì¶”ì²œ ë¼ì´ë¸ŒëŸ¬ë¦¬**: ì—†ìŒ (í•œêµ­ì–´ ì§€ì› ë¶€ì¡±)

**ë¬¸ì œì **:
- âŒ Summarization ë¼ì´ë¸ŒëŸ¬ë¦¬ ëŒ€ë¶€ë¶„ ì˜ì–´ ì „ìš©
- âŒ `nlp-compromise`, `natural` â†’ í•œêµ­ì–´ ë¯¸ì§€ì›
- âŒ `text-summarization` â†’ í†µê³„ ê¸°ë°˜, ê°ì • ë¬´ì‹œ

---

### ì˜µì…˜ 3: í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼ (AI + ê·œì¹™ ê¸°ë°˜)
**ì¥ì **:
- âœ… ë¹„ìš© ì ˆê° (API 1íšŒë§Œ)
- âœ… ë¹ ë¥¸ ì²˜ë¦¬
- âœ… ì •í™•í•œ ê¸¸ì´ ì œì–´

**êµ¬í˜„ ë°©ë²•**:
```javascript
// 1ë‹¨ê³„: AIë¡œ 100ì ìš”ì•½
const detailedSummary = AIìš”ì•½("ì‚¬ìš©ì ë°œì–¸", "100ì");

// 2ë‹¨ê³„: ê·œì¹™ ê¸°ë°˜ 30ì ì••ì¶•
const compactSummary = extractKeywords(detailedSummary, 30);
```

**ê·œì¹™ ê¸°ë°˜ ì••ì¶• ë¡œì§**:
- ëª…ì‚¬ ì¶”ì¶œ (í•œêµ­ì–´ í˜•íƒœì†Œ ë¶„ì„)
- ë¶ˆìš©ì–´ ì œê±°
- ì¤‘ìš”ë„ ìˆœ ì •ë ¬
- 30ìê¹Œì§€ ê²°í•©

**ë¬¸ì œì **:
- âŒ í•œêµ­ì–´ í˜•íƒœì†Œ ë¶„ì„ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”
- âŒ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì²˜ë¦¬ ë¶€ë‹´

---

## ğŸ¯ ê¶Œì¥ ì†”ë£¨ì…˜: AI ê¸°ë°˜ 2ë‹¨ê³„ ìš”ì•½ (ìµœì í™”)

### ì´ìœ 
1. **ì •í™•ì„±**: AIê°€ ê°ì •/ë§¥ë½ ì´í•´ ê°€ëŠ¥
2. **ìœ ì—°ì„±**: ì‚¬ìš©ì ë°œì–¸ë§Œ ì¶”ì¶œ ê°€ëŠ¥
3. **ì‹ ë¢°ì„±**: ê·œì¹™ ê¸°ë°˜ë³´ë‹¤ ìì—°ìŠ¤ëŸ¬ìš´ ìš”ì•½

### ìµœì í™” ì „ëµ
```javascript
// ë‹¨ì¼ API í˜¸ì¶œë¡œ 2ê°€ì§€ ìš”ì•½ ë™ì‹œ ìƒì„±
const summaryPrompt = `
ì‚¬ìš©ìì˜ ë°œì–¸ë§Œì„ ë¶„ì„í•˜ì—¬ 2ê°€ì§€ ìš”ì•½ì„ ìƒì„±í•´ì¤˜.

ì‚¬ìš©ì ë°œì–¸: "${userMessages}"

ì‘ë‹µ í˜•ì‹ (ë°˜ë“œì‹œ JSONë§Œ ì¶œë ¥):
{
  "detailed": "100ì ì´ë‚´ ìì„¸í•œ ìš”ì•½ (ì¼ê¸°ì²´, 1ì¸ì¹­)",
  "compact": "30ì ì´ë‚´ í•µì‹¬ ìš”ì•½ (ëª…ì‚¬ ì¤‘ì‹¬)"
}

ê·œì¹™:
- detailed: ë‚˜ì˜ ê²½í—˜, ê°ì •, ìƒê° ì¤‘ì‹¬ìœ¼ë¡œ ì„œìˆ  (90-100ì)
- compact: í•µì‹¬ ì£¼ì œë§Œ ê°„ê²°í•˜ê²Œ (25-30ì)
- JSON í˜•ì‹ë§Œ ì¶œë ¥, ì¶”ê°€ ì„¤ëª… ê¸ˆì§€
`;
```

### ì¥ì 
- âœ… API í˜¸ì¶œ 1íšŒë§Œ (ë¹„ìš© ì ˆê°)
- âœ… ë™ì‹œ ìƒì„±ìœ¼ë¡œ ì¼ê´€ì„± ìœ ì§€
- âœ… JSON íŒŒì‹±ìœ¼ë¡œ ì •í™•í•œ êµ¬ë¶„

---

## ğŸ“ êµ¬í˜„ ì˜ˆì‹œ

### Before (í˜„ì¬)
```javascript
const summaryText = await AIìš”ì•½(ì „ì²´ëŒ€í™”, "200ì");
// â†’ AI ì‘ë‹µë„ í¬í•¨, ë‹¨ì¼ ìš”ì•½ë§Œ
```

### After (ê°œì„ ì•ˆ)
```javascript
const userOnlyMessages = msgs
  .filter(m => m.role === 'user')
  .map(m => m.content)
  .join(' ');

const summaryPrompt = `
ì‚¬ìš©ìì˜ ë°œì–¸ë§Œì„ ë¶„ì„í•˜ì—¬ 2ê°€ì§€ ìš”ì•½ì„ ìƒì„±í•´ì¤˜.

ì‚¬ìš©ì ë°œì–¸: "${userOnlyMessages}"

ì‘ë‹µ í˜•ì‹ (ë°˜ë“œì‹œ JSONë§Œ ì¶œë ¥):
{
  "detailed": "100ì ì´ë‚´ ìì„¸í•œ ìš”ì•½",
  "compact": "30ì ì´ë‚´ í•µì‹¬ ìš”ì•½"
}

detailed ê·œì¹™:
- "ë‚˜ëŠ” ~í–ˆë‹¤", "ë‚´ê°€ ~" í˜•ì‹ìœ¼ë¡œ 1ì¸ì¹­ ê´€ì 
- ê²½í—˜, ê°ì •, ìƒê°, ê³ ë¯¼ ì¤‘ì‹¬ìœ¼ë¡œ ì„œìˆ 
- ì¼ê¸°ì²´ì²˜ëŸ¼ ìì—°ìŠ¤ëŸ½ê³  ì†”ì§í•˜ê²Œ
- 90-100ì ì´ë‚´ ì™„ì„±ëœ ë‚´ìš©
- ë¶€ì •ì  ê°ì •ë„ ìˆëŠ” ê·¸ëŒ€ë¡œ í‘œí˜„

compact ê·œì¹™:
- í•µì‹¬ ì£¼ì œë§Œ ê°„ê²°í•˜ê²Œ
- ëª…ì‚¬ ì¤‘ì‹¬ (ë™ì‚¬/í˜•ìš©ì‚¬ ìµœì†Œí™”)
- 25-30ì ì´ë‚´
- ì´í›„ ëŒ€í™” ë§¥ë½ ì œê³µìš©

JSON í˜•ì‹ë§Œ ì¶œë ¥, ì¶”ê°€ ì„¤ëª… ê¸ˆì§€
`;

const res = await chat({ conversation_id: id, user_id: user.id, content: summaryPrompt });
const summaries = JSON.parse(res.assistant.trim());

const detailedSummary = summaries.detailed; // 100ì (ì‚¬ìš©ì í‘œì‹œ)
const compactSummary = summaries.compact;   // 30ì (ì¥ê¸° ê¸°ì–µ)
```

---

## ğŸ“Š ì„±ëŠ¥ ë¹„êµ

| ë°©ë²• | API í˜¸ì¶œ | ì²˜ë¦¬ ì‹œê°„ | ë¹„ìš© | ì •í™•ë„ | í•œêµ­ì–´ ì§€ì› |
|------|---------|---------|------|--------|------------|
| **ê¸°ì¡´** | 1íšŒ | 2-3ì´ˆ | ë‚®ìŒ | 70% | âœ… |
| **2ë‹¨ê³„ AI** | 2íšŒ | 4-6ì´ˆ | ë†’ìŒ | 95% | âœ… |
| **ë‹¨ì¼ JSON** | 1íšŒ | 2-3ì´ˆ | ë‚®ìŒ | 90% | âœ… |
| **í•˜ì´ë¸Œë¦¬ë“œ** | 1íšŒ | 3-4ì´ˆ | ì¤‘ê°„ | 75% | âš ï¸ |

**ê¶Œì¥**: ë‹¨ì¼ JSON ë°©ì‹ (ìµœê³  íš¨ìœ¨)

---

## âœ… ìµœì¢… ê¶Œì¥ì‚¬í•­

### 1. ë‹¨ì¼ API í˜¸ì¶œ + JSON ì‘ë‹µ
- API í˜¸ì¶œ 1íšŒë¡œ 2ê°€ì§€ ìš”ì•½ ë™ì‹œ ìƒì„±
- ë¹„ìš© íš¨ìœ¨ì 
- ì¼ê´€ì„± ìœ ì§€

### 2. ì‚¬ìš©ì ë°œì–¸ë§Œ í•„í„°ë§
```javascript
const userOnlyMessages = msgs
  .filter(m => m.role === 'user')
  .map(m => m.content)
  .join(' ');
```

### 3. ëª…í™•í•œ ê¸¸ì´ ì œí•œ
- detailed: 90-100ì
- compact: 25-30ì

### 4. JSON íŒŒì‹± ì•ˆì „ì¥ì¹˜
```javascript
try {
  const summaries = JSON.parse(res.assistant.trim());
  detailedSummary = summaries.detailed;
  compactSummary = summaries.compact;
} catch (error) {
  // Fallback: ê¸°ì¡´ ë°©ì‹
  detailedSummary = res.assistant.substring(0, 100);
  compactSummary = res.assistant.substring(0, 30);
}
```

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

1. âœ… ìš”ì•½ í”„ë¡¬í”„íŠ¸ ìˆ˜ì •
2. âœ… ì‚¬ìš©ì ë°œì–¸ í•„í„°ë§ ì¶”ê°€
3. âœ… JSON íŒŒì‹± ë¡œì§ êµ¬í˜„
4. âœ… ì €ì¥ ë¡œì§ ìˆ˜ì • (detailed/compact ë¶„ë¦¬)
5. âœ… UI ì—…ë°ì´íŠ¸ (History.jsì—ì„œ í‘œì‹œ)

**ì˜ˆìƒ ê°œì„  íš¨ê³¼**:
- ì‚¬ìš©ì ë°œì–¸ ì¤‘ì‹¬: 100%
- ê¸¸ì´ ì •í™•ë„: 90% â†’ 95%
- ë¹„ìš© íš¨ìœ¨: ë™ì¼ (API 1íšŒ)
- ì²˜ë¦¬ ì‹œê°„: ë™ì¼ (2-3ì´ˆ)
