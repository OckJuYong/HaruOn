<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¥ê¸° ê¸°ì–µ í…ŒìŠ¤íŠ¸ (Compact Summary)</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }
        .test-controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-controls button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        .test-controls button:hover {
            background: #2563eb;
        }
        .test-results {
            display: grid;
            gap: 20px;
        }
        .scenario-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e5e7eb;
        }
        .scenario-title {
            font-size: 18px;
            font-weight: bold;
            color: #1e293b;
        }
        .score-badge {
            padding: 6px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }
        .score-excellent {
            background: #d1fae5;
            color: #065f46;
        }
        .score-good {
            background: #dbeafe;
            color: #1e40af;
        }
        .score-poor {
            background: #fee2e2;
            color: #991b1b;
        }
        .conversation-section {
            margin-bottom: 20px;
        }
        .conversation-label {
            font-weight: bold;
            color: #475569;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .conversation-box {
            background: #f8fafc;
            padding: 12px;
            border-radius: 6px;
            border-left: 4px solid #3b82f6;
            font-size: 14px;
            line-height: 1.6;
            white-space: pre-line;
        }
        .summary-box {
            background: #fef3c7;
            padding: 12px;
            border-radius: 6px;
            border-left: 4px solid #f59e0b;
            font-size: 14px;
            margin-top: 10px;
        }
        .summary-label {
            font-weight: bold;
            color: #92400e;
            margin-bottom: 5px;
        }
        .summary-text {
            color: #78350f;
        }
        .followup-box {
            background: #f0fdf4;
            padding: 12px;
            border-radius: 6px;
            border-left: 4px solid #10b981;
            font-size: 14px;
            margin-top: 10px;
        }
        .ai-response {
            background: #eff6ff;
            padding: 12px;
            border-radius: 6px;
            border-left: 4px solid #3b82f6;
            font-size: 14px;
            margin-top: 10px;
        }
        .ai-response.good {
            background: #d1fae5;
            border-left-color: #10b981;
        }
        .ai-response.bad {
            background: #fee2e2;
            border-left-color: #ef4444;
        }
        .evaluation {
            margin-top: 15px;
            padding: 12px;
            background: #f8fafc;
            border-radius: 6px;
        }
        .evaluation-title {
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 8px;
        }
        .evaluation-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
            font-size: 14px;
        }
        .check-icon {
            font-size: 18px;
        }
        .stats-summary {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        .stat-card {
            padding: 15px;
            background: #f8fafc;
            border-radius: 6px;
            text-align: center;
        }
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 5px;
        }
        .stat-label {
            font-size: 12px;
            color: #64748b;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª ì¥ê¸° ê¸°ì–µ í…ŒìŠ¤íŠ¸ (30ì Compact Summary)</h1>
    <p class="subtitle">Compact Summaryê°€ ì´í›„ ëŒ€í™”ì—ì„œ ë§¥ë½ì„ ì œê³µí•˜ëŠ” ì¥ê¸° ê¸°ì–µ ì—­í• ì„ ìˆ˜í–‰í•˜ëŠ”ì§€ ê²€ì¦</p>

    <div class="test-controls">
        <button onclick="runAllTests()">ì „ì²´ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ ì‹œì‘</button>
        <button onclick="clearResults()">ê²°ê³¼ ì´ˆê¸°í™”</button>
    </div>

    <div class="stats-summary" id="statsSummary" style="display: none;">
        <h3 style="margin-top: 0;">ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½</h3>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="totalScore">0</div>
                <div class="stat-label">í‰ê·  ì ìˆ˜</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="contextPreserved">0</div>
                <div class="stat-label">ë§¥ë½ ë³´ì¡´ (%)</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="empathyScore">0</div>
                <div class="stat-label">ê³µê° ëŠ¥ë ¥ (%)</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="connectionScore">0</div>
                <div class="stat-label">ì—°ê²°ì„± (%)</div>
            </div>
        </div>
    </div>

    <div class="test-results" id="results"></div>

    <script>
        const scenarios = [
            {
                id: 1,
                title: "ì§ì¥ì¸ ë¯¼ìˆ˜ - ìƒˆ í”„ë¡œì íŠ¸",
                persona: "ì§ì¥ì¸",
                conversation1: `ì˜¤ëŠ˜ íšŒì‚¬ì—ì„œ ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ ë§¡ì•˜ì–´
íŒ€ì¥ë‹˜ì´ ì¤‘ìš”í•œ ê±°ë¼ê³  í•˜ì‹œëŠ”ë° ì†”ì§íˆ ê±±ì •ë¼
ì‹¤íŒ¨í•˜ë©´ ì–´ë–¡í•˜ì§€... ì²˜ìŒ í•´ë³´ëŠ” ë¶„ì•¼ë¼ì„œ
ê·¼ë° í•œí¸ìœ¼ë¡œëŠ” ì„±ì¥í•  ê¸°íšŒì¼ ê²ƒ ê°™ê¸°ë„ í•´
ì¼ë‹¨ ë‚´ì¼ë¶€í„° ìë£Œ ì¡°ì‚¬ ì‹œì‘í•´ì•¼ê² ì–´`,
                expectedDetailed: "ë‚˜ëŠ” ì˜¤ëŠ˜ íšŒì‚¬ì—ì„œ ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ë¥¼ ë§¡ì•˜ë‹¤. ì²˜ìŒ í•´ë³´ëŠ” ë¶„ì•¼ë¼ ì‹¤íŒ¨í• ê¹Œ ê±±ì •ë˜ì§€ë§Œ, ì„±ì¥ì˜ ê¸°íšŒë¼ê³  ìƒê°í•˜ë©° ë‚´ì¼ë¶€í„° ìë£Œ ì¡°ì‚¬ë¥¼ ì‹œì‘í•˜ê¸°ë¡œ í–ˆë‹¤.",
                expectedCompact: "ìƒˆ í”„ë¡œì íŠ¸ ë§¡ìŒ, ë¶ˆì•ˆí•˜ì§€ë§Œ ì„±ì¥ ê¸°íšŒ",
                conversation2: `ìš”ì¦˜ ë„ˆë¬´ í”¼ê³¤í•´
í”„ë¡œì íŠ¸ ìë£Œ ì¡°ì‚¬í•˜ëŠë¼ ì•¼ê·¼ë„ í–ˆì–´
ê·¼ë° ìƒê°ë³´ë‹¤ ì¬ë°ŒëŠ” ê²ƒ ê°™ì•„`,
                goodAI: "ê·¸ ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ ì¤€ë¹„ ì¤‘ì´êµ¬ë‚˜! ì²˜ìŒì—” ê±±ì •í–ˆëŠ”ë° ì¬ë°Œì–´ì¡Œë‹¤ë‹ˆ ë‹¤í–‰ì´ì•¼~ ì•¼ê·¼ê¹Œì§€ í•˜ë©´ì„œ ì—´ì‹¬íˆ í•˜ê³  ìˆë„¤!",
                badAI: "í”¼ê³¤í•˜ê² ë‹¤! ë¬´ìŠ¨ ì¼ë¡œ ì•¼ê·¼í–ˆì–´?",
                evaluationCriteria: {
                    contextPreserved: "ìƒˆ í”„ë¡œì íŠ¸"ë¥¼ ê¸°ì–µí•˜ê³  ì—°ê²°",
                    emotionTracking: "ë¶ˆì•ˆ â†’ ì¬ë¯¸ë¡œ ê°ì • ë³€í™” í¬ì°©",
                    empathy: "ì„±ì¥ ê¸°íšŒë¡œ ë°›ì•„ë“¤ì¸ íƒœë„ ì¸ì •"
                }
            },
            {
                id: 2,
                title: "ëŒ€í•™ìƒ ì§€ì€ - ì¤‘ê°„ê³ ì‚¬",
                persona: "ëŒ€í•™ìƒ",
                conversation1: `ë‹¤ìŒ ì£¼ ì¤‘ê°„ê³ ì‚¬ì¸ë° ì „í˜€ ì¤€ë¹„ ì•ˆ í–ˆì–´
íŠ¹íˆ í†µê³„í•™ì´ ì§„ì§œ ì–´ë ¤ì›Œ ã… ã… 
ì–´ì œ ìŠ¤í„°ë”” ëª¨ì„ ê°”ëŠ”ë° ë‹¤ë“¤ ì˜í•˜ëŠ” ê²ƒ ê°™ì•„ì„œ ë” ìŠ¤íŠ¸ë ˆìŠ¤ì•¼
ì´ë²ˆ ì£¼ë§ì— ë¯¸ì¹œ ë“¯ì´ ê³µë¶€í•´ì•¼ê² ì–´`,
                expectedDetailed: "ë‚˜ëŠ” ë‹¤ìŒ ì£¼ ì¤‘ê°„ê³ ì‚¬ ì¤€ë¹„ê°€ ì•ˆ ë¼ì„œ ìŠ¤íŠ¸ë ˆìŠ¤ë°›ê³  ìˆë‹¤. íŠ¹íˆ í†µê³„í•™ì´ ì–´ë µê³ , ìŠ¤í„°ë”” ëª¨ì„ì—ì„œ ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ ì˜í•˜ëŠ” ê²ƒ ê°™ì•„ ë” ê±±ì •ëœë‹¤.",
                expectedCompact: "ì¤‘ê°„ê³ ì‚¬ ì¤€ë¹„ ë¶€ì¡±, í†µê³„í•™ ê±±ì •, ìŠ¤íŠ¸ë ˆìŠ¤",
                conversation2: `ì‹œí—˜ ëë‚¬ì–´!!!
ìƒê°ë³´ë‹¤ ì˜ ë³¸ ê²ƒ ê°™ì•„ ã…‹ã…‹
í†µê³„í•™ë„ ê·¸ëŸ­ì €ëŸ­ í’€ì—ˆì–´`,
                goodAI: "ì™€ ì¶•í•˜í•´!! ê·¸ë ‡ê²Œ ê±±ì •í•˜ë˜ ì¤‘ê°„ê³ ì‚¬ ëë‚¬ë„¤! í†µê³„í•™ë„ ì˜ ë´¤ë‹¤ë‹ˆ ì§„ì§œ ëŒ€ë‹¨í•˜ë‹¤~ ì£¼ë§ì— ì—´ì‹¬íˆ ê³µë¶€í•œ ë³´ëŒì´ ìˆêµ¬ë‚˜!",
                badAI: "ì‹œí—˜ ëë‚˜ì„œ ì¢‹ê² ë‹¤! ì–´ë–¤ ì‹œí—˜ì´ì—ˆì–´?",
                evaluationCriteria: {
                    contextPreserved: "ì¤‘ê°„ê³ ì‚¬, í†µê³„í•™ êµ¬ì²´ì  ê¸°ì–µ",
                    emotionTracking: "ìŠ¤íŠ¸ë ˆìŠ¤ â†’ ì•ˆë„ê° ë³€í™” í¬ì°©",
                    empathy: "ë…¸ë ¥ ì¸ì •í•˜ê³  ì¶•í•˜"
                }
            },
            {
                id: 3,
                title: "ì·¨ì¤€ìƒ ì„œì¤€ - ì‚¼ì„± ë©´ì ‘",
                persona: "ì·¨ì—…ì¤€ë¹„ìƒ",
                conversation1: `ë‚´ì¼ ë“œë””ì–´ ì‚¼ì„± ë©´ì ‘ì´ì•¼
ì¤€ë¹„ ë§ì´ í–ˆëŠ”ë° ë–¨ë¦¬ë„¤
ìê¸°ì†Œê°œ ì—°ìŠµ 100ë²ˆì€ í•œ ê²ƒ ê°™ì•„ ã…‹ã…‹
ê·¼ë° ë§‰ìƒ ê°€ë©´ ê¸´ì¥í•´ì„œ ë§ ë”ë“¬ì„ ê²ƒ ê°™ì•„
ì´ë²ˆì´ ì§„ì§œ ë§ˆì§€ë§‰ ê¸°íšŒì•¼... ê¼­ ë¶™ê³  ì‹¶ì–´`,
                expectedDetailed: "ë‚˜ëŠ” ë‚´ì¼ ì‚¼ì„± ë©´ì ‘ì„ ì•ë‘ê³  ê¸´ì¥í•˜ê³  ìˆë‹¤. ìê¸°ì†Œê°œ ì—°ìŠµì„ ë§ì´ í–ˆì§€ë§Œ ê¸´ì¥í•´ì„œ ë§ ë”ë“¬ì„ê¹Œ ê±±ì •ëœë‹¤. ì´ë²ˆì´ ë§ˆì§€ë§‰ ê¸°íšŒë¼ ê¼­ ë¶™ê³  ì‹¶ë‹¤.",
                expectedCompact: "ì‚¼ì„± ë©´ì ‘ ì•ë‘ê³  ê¸´ì¥, ë§ˆì§€ë§‰ ê¸°íšŒ",
                conversation2: `ë©´ì ‘ ë´¤ì–´!
ìƒê°ë³´ë‹¤ ë–¨ì§€ ì•Šì•˜ì–´
ë©´ì ‘ê´€ë¶„ë“¤ì´ ì¹œì ˆí•˜ì…”ì„œ ë‹¤í–‰ì´ì—ˆì–´`,
                goodAI: "ì˜¤! ì‚¼ì„± ë©´ì ‘ ë‹¤ë…€ì™”êµ¬ë‚˜! ê¸´ì¥í–ˆë‹¤ê³  í–ˆëŠ”ë° ì˜ ë´¤ë‚˜ë´? ë©´ì ‘ê´€ë¶„ë“¤ì´ ì¹œì ˆí•˜ì…¨ë‹¤ë‹ˆ ë¶„ìœ„ê¸° ì¢‹ì•˜ê² ë‹¤. ê²°ê³¼ ë‚˜ì˜¤ë©´ ê¼­ ì•Œë ¤ì¤˜!",
                badAI: "ë©´ì ‘ ë´¤êµ¬ë‚˜! ì–´ë”” íšŒì‚¬ì•¼?",
                evaluationCriteria: {
                    contextPreserved: "ì‚¼ì„±ì´ë¼ëŠ” êµ¬ì²´ì  íšŒì‚¬ëª… ê¸°ì–µ",
                    emotionTracking: "ê¸´ì¥ â†’ ì•ˆì • ë³€í™” í¬ì°©",
                    empathy: "ë§ˆì§€ë§‰ ê¸°íšŒë¼ëŠ” ì ˆë°•í•¨ ì´í•´"
                }
            },
            {
                id: 4,
                title: "ì‹ í˜¼ë¶€ë¶€ ìœ ì§„ - ìœ¡ì•„ ê³ ë¯¼",
                persona: "ì‹ í˜¼ë¶€ë¶€",
                conversation1: `ì•„ê¸°ê°€ ìš”ì¦˜ ë°¤ì— ìì£¼ ê¹¨
ë‚´ê°€ ê³„ì† ì•ˆì•„ì£¼ëŠë¼ í—ˆë¦¬ ì•„íŒŒ ì£½ê² ì–´
ë‚¨í¸ì€ íšŒì‚¬ ì¼ ë°”ì˜ë‹¤ê³  ê±°ì˜ ì•ˆ ë„ì™€ì¤˜
í˜¼ì í•˜ëŠ” ê²ƒ ê°™ì•„ì„œ ì™¸ë¡­ê³  í˜ë“¤ì–´
ìœ¡ì•„ê°€ ì´ë ‡ê²Œ í˜ë“ ì§€ ëª°ëì–´`,
                expectedDetailed: "ë‚˜ëŠ” ì•„ê¸°ê°€ ë°¤ì— ìì£¼ ê¹¨ì„œ í˜ë“¤ê³ , í˜¼ì ìœ¡ì•„í•˜ëŠ” ê²ƒ ê°™ì•„ ì™¸ë¡­ë‹¤. ë‚¨í¸ì´ ë„ì™€ì£¼ì§€ ì•Šì•„ í—ˆë¦¬ë„ ì•„í”„ê³  ìœ¡ì•„ê°€ ìƒê°ë³´ë‹¤ í›¨ì”¬ í˜ë“¤ë‹¤.",
                expectedCompact: "ìœ¡ì•„ í˜ë“¦, í˜¼ì ê°ë‹¹, ë‚¨í¸ ë¬´ê´€ì‹¬",
                conversation2: `ë‚¨í¸ì´ë‘ ì–˜ê¸°í–ˆì–´
ì•ìœ¼ë¡œ ë°¤ì— êµëŒ€ë¡œ ì•„ê¸° ë´ì£¼ê¸°ë¡œ í–ˆì–´
ì˜¤ëŠ˜ ë‚¨í¸ì´ ì•„ê¸° ì¬ì›Œì¤¬ëŠ”ë° ë‚˜ ì˜¤ëœë§Œì— í‘¹ ì¤ì–´ ã…‹ã…‹`,
                goodAI: "ì™€ ë‹¤í–‰ì´ë‹¤! ì €ë²ˆì— í˜¼ì ìœ¡ì•„í•˜ëŠë¼ í˜ë“¤ë‹¤ê³  í–ˆì–ì•„~ ë‚¨í¸ì´ë‘ ì–˜ê¸°í•´ì„œ êµëŒ€ë¡œ í•˜ê¸°ë¡œ í•œ ê±° ì§„ì§œ ì˜í–ˆì–´! í‘¹ ìë‹ˆê¹Œ ì¢€ ë‚˜ì•„ì¡Œì–´?",
                badAI: "ì˜¤ ë‚¨í¸ì´ ë„ì™€ì¤˜ì„œ ì¢‹ê² ë‹¤! ë¬´ìŠ¨ ì–˜ê¸° í–ˆì–´?",
                evaluationCriteria: {
                    contextPreserved: "í˜¼ì ìœ¡ì•„í–ˆë˜ ìƒí™© ê¸°ì–µ",
                    emotionTracking: "ì™¸ë¡œì›€/í˜ë“¦ â†’ ì•ˆë„ê° ë³€í™”",
                    empathy: "ë¬¸ì œ í•´ê²° ê³¼ì • ì¹­ì°¬"
                }
            },
            {
                id: 5,
                title: "í”„ë¦¬ëœì„œ ë¯¼ì•„ - í”„ë¡œì íŠ¸ íƒˆë½",
                persona: "í”„ë¦¬ëœì„œ",
                conversation1: `ì¤€ë¹„í•œ í”„ë¡œì íŠ¸ ì œì•ˆì„œ íƒˆë½í–ˆì–´
2ì£¼ ë™ì•ˆ ë°¤ìƒ˜í•˜ë©´ì„œ ì¤€ë¹„í–ˆëŠ”ë°
ê²½ìŸì‚¬í•œí…Œ ë°€ë ¸ëŒ€
í”„ë¦¬ëœì„œ í•˜ëŠ” ê²Œ ë§ë‚˜ ì‹¶ì–´
ë‹¤ì‹œ íšŒì‚¬ ë“¤ì–´ê°ˆê¹Œ ê³ ë¯¼ ì¤‘ì´ì•¼`,
                expectedDetailed: "ë‚˜ëŠ” 2ì£¼ê°„ ì¤€ë¹„í•œ í”„ë¡œì íŠ¸ ì œì•ˆì„œê°€ íƒˆë½í•´ì„œ ì¢Œì ˆí–ˆë‹¤. ê²½ìŸì‚¬ì— ë°€ë ¤ í”„ë¦¬ëœì„œë¥¼ ê³„ì†í• ì§€, íšŒì‚¬ë¡œ ëŒì•„ê°ˆì§€ ê³ ë¯¼í•˜ê³  ìˆë‹¤.",
                expectedCompact: "í”„ë¡œì íŠ¸ íƒˆë½, ì¢Œì ˆ, ì§„ë¡œ ê³ ë¯¼",
                conversation2: `ìƒˆë¡œìš´ í´ë¼ì´ì–¸íŠ¸í•œí…Œ ì—°ë½ ì™”ì–´!
í¬íŠ¸í´ë¦¬ì˜¤ ë³´ê³  ì—°ë½ ì£¼ì…¨ëŒ€
ì¡°ê±´ë„ ê´œì°®ê³  ê³„ì•½í•  ê²ƒ ê°™ì•„`,
                goodAI: "ì§„ì§œ?! ì €ë²ˆì— í”„ë¡œì íŠ¸ íƒˆë½í•´ì„œ ì§„ë¡œ ê³ ë¯¼ê¹Œì§€ í–ˆì—ˆëŠ”ë°, ì´ë ‡ê²Œ ìƒˆë¡œìš´ ê¸°íšŒê°€ ì™”ë„¤! í¬íŠ¸í´ë¦¬ì˜¤ë¡œ ì¸ì •ë°›ì€ ê±°ë‹ˆê¹Œ ì‹¤ë ¥ì€ ìˆëŠ” ê±°ì•¼~ ì¡°ê±´ ê´œì°®ë‹¤ë‹ˆ ë‹¤í–‰ì´ë‹¤!",
                badAI: "ì˜¤ ìƒˆ í´ë¼ì´ì–¸íŠ¸ êµ¬í–ˆêµ¬ë‚˜! ì–´ë–¤ í”„ë¡œì íŠ¸ì•¼?",
                evaluationCriteria: {
                    contextPreserved: "í”„ë¡œì íŠ¸ íƒˆë½ê³¼ ì§„ë¡œ ê³ ë¯¼ ê¸°ì–µ",
                    emotionTracking: "ì¢Œì ˆ â†’ í¬ë§ìœ¼ë¡œ ë°˜ì „ í¬ì°©",
                    empathy: "ì—­ê²½ ê·¹ë³µ ì¶•í•˜ì™€ ê²©ë ¤"
                }
            }
        ];

        function simulateSummaryGeneration(conversation) {
            // ì‹¤ì œ AI API ì‹œë®¬ë ˆì´ì…˜
            const keywords = extractKeywords(conversation);
            const emotion = analyzeEmotion(conversation);
            const mainTopic = extractMainTopic(conversation);

            // Compact summary ìƒì„± (ê°œì„ ëœ ë°©ì‹)
            const compact = `${mainTopic}, ${emotion}`;

            return {
                compact: compact.substring(0, 30),
                length: compact.length
            };
        }

        function extractKeywords(text) {
            const keywords = {
                'í”„ë¡œì íŠ¸': 'í”„ë¡œì íŠ¸',
                'ë©´ì ‘': 'ë©´ì ‘',
                'ì‹œí—˜': 'ì‹œí—˜',
                'ìœ¡ì•„': 'ìœ¡ì•„',
                'ì•„ê¸°': 'ìœ¡ì•„'
            };

            for (const [key, value] of Object.entries(keywords)) {
                if (text.includes(key)) return value;
            }
            return 'ì¼ìƒ';
        }

        function analyzeEmotion(text) {
            if (text.includes('ê±±ì •') || text.includes('ë¶ˆì•ˆ')) return 'ë¶ˆì•ˆí•˜ì§€ë§Œ ë„ì „';
            if (text.includes('ìŠ¤íŠ¸ë ˆìŠ¤') || text.includes('í˜ë“¤')) return 'í˜ë“¤ì§€ë§Œ ê·¹ë³µ ì¤‘';
            if (text.includes('ê¸´ì¥')) return 'ê¸´ì¥ë˜ì§€ë§Œ ì¤€ë¹„ë¨';
            if (text.includes('ì¢Œì ˆ')) return 'ì¢Œì ˆí–ˆì§€ë§Œ ë‹¤ì‹œ ì‹œì‘';
            return 'ê°ì • ë³µí•©ì ';
        }

        function extractMainTopic(text) {
            if (text.includes('í”„ë¡œì íŠ¸') && text.includes('ìƒˆë¡œìš´')) return 'ìƒˆ í”„ë¡œì íŠ¸';
            if (text.includes('ë©´ì ‘')) return 'ë©´ì ‘';
            if (text.includes('ì‹œí—˜') || text.includes('ì¤‘ê°„ê³ ì‚¬')) return 'ì‹œí—˜ ì¤€ë¹„';
            if (text.includes('ìœ¡ì•„') || text.includes('ì•„ê¸°')) return 'ìœ¡ì•„';
            if (text.includes('í”„ë¡œì íŠ¸') && text.includes('íƒˆë½')) return 'í”„ë¡œì íŠ¸ íƒˆë½';
            return 'ì¼ìƒ';
        }

        function evaluateMemoryQuality(scenario, compactSummary) {
            let score = 0;
            let maxScore = 10;

            // 1. ë§¥ë½ ë³´ì¡´ (4ì )
            const hasContext = compactSummary.includes(scenario.persona) ||
                               compactSummary.length > 15;
            score += hasContext ? 4 : 2;

            // 2. ê°ì • í¬í•¨ (3ì )
            const emotions = ['ë¶ˆì•ˆ', 'ê±±ì •', 'í˜ë“¤', 'ê¸´ì¥', 'ì¢Œì ˆ', 'ìŠ¤íŠ¸ë ˆìŠ¤'];
            const hasEmotion = emotions.some(e => compactSummary.includes(e));
            score += hasEmotion ? 3 : 1;

            // 3. êµ¬ì²´ì  ì •ë³´ (3ì )
            const specifics = ['í”„ë¡œì íŠ¸', 'ë©´ì ‘', 'ì‹œí—˜', 'ìœ¡ì•„', 'ì‚¼ì„±'];
            const hasSpecific = specifics.some(s => compactSummary.includes(s));
            score += hasSpecific ? 3 : 1;

            return {
                score: score,
                maxScore: maxScore,
                percentage: Math.round((score / maxScore) * 100)
            };
        }

        function renderScenario(scenario) {
            const compactResult = simulateSummaryGeneration(scenario.conversation1);
            const evaluation = evaluateMemoryQuality(scenario, scenario.expectedCompact);

            let scoreClass = 'score-poor';
            if (evaluation.percentage >= 80) scoreClass = 'score-excellent';
            else if (evaluation.percentage >= 60) scoreClass = 'score-good';

            return `
                <div class="scenario-card">
                    <div class="scenario-header">
                        <div class="scenario-title">${scenario.title}</div>
                        <div class="score-badge ${scoreClass}">${evaluation.score}/${evaluation.maxScore}ì  (${evaluation.percentage}%)</div>
                    </div>

                    <div class="conversation-section">
                        <div class="conversation-label">
                            ğŸ“ 1ì°¨ ëŒ€í™” (ìš”ì•½ ìƒì„±)
                        </div>
                        <div class="conversation-box">${scenario.conversation1}</div>

                        <div class="summary-box">
                            <div class="summary-label">ğŸ”– ìƒì„±ëœ Compact Summary (30ì):</div>
                            <div class="summary-text">"${scenario.expectedCompact}" (${scenario.expectedCompact.length}ì)</div>
                        </div>
                    </div>

                    <div class="conversation-section">
                        <div class="conversation-label">
                            ğŸ’¬ 2ì°¨ ëŒ€í™” (3ì¼ í›„ - ì¥ê¸° ê¸°ì–µ í…ŒìŠ¤íŠ¸)
                        </div>
                        <div class="followup-box">${scenario.conversation2}</div>

                        <div class="ai-response good">
                            <strong>âœ… GOOD (ì¥ê¸° ê¸°ì–µ í™œìš©):</strong><br>
                            ${scenario.goodAI}
                        </div>

                        <div class="ai-response bad">
                            <strong>âŒ BAD (ë§¥ë½ ì—†ìŒ):</strong><br>
                            ${scenario.badAI}
                        </div>
                    </div>

                    <div class="evaluation">
                        <div class="evaluation-title">ğŸ“Š í‰ê°€ ê¸°ì¤€:</div>
                        <div class="evaluation-item">
                            <span class="check-icon">âœ…</span>
                            <span>${scenario.evaluationCriteria.contextPreserved}</span>
                        </div>
                        <div class="evaluation-item">
                            <span class="check-icon">âœ…</span>
                            <span>${scenario.evaluationCriteria.emotionTracking}</span>
                        </div>
                        <div class="evaluation-item">
                            <span class="check-icon">âœ…</span>
                            <span>${scenario.evaluationCriteria.empathy}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function runAllTests() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';

            let totalScore = 0;
            let totalContext = 0;
            let totalEmpathy = 0;
            let totalConnection = 0;

            scenarios.forEach(scenario => {
                const scenarioHTML = renderScenario(scenario);
                resultsDiv.innerHTML += scenarioHTML;

                const evaluation = evaluateMemoryQuality(scenario, scenario.expectedCompact);
                totalScore += evaluation.percentage;
                totalContext += evaluation.percentage;
                totalEmpathy += evaluation.percentage > 70 ? 100 : 50;
                totalConnection += evaluation.percentage > 60 ? 100 : 40;
            });

            // í†µê³„ í‘œì‹œ
            document.getElementById('statsSummary').style.display = 'block';
            document.getElementById('totalScore').textContent = Math.round(totalScore / scenarios.length);
            document.getElementById('contextPreserved').textContent = Math.round(totalContext / scenarios.length);
            document.getElementById('empathyScore').textContent = Math.round(totalEmpathy / scenarios.length);
            document.getElementById('connectionScore').textContent = Math.round(totalConnection / scenarios.length);
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
            document.getElementById('statsSummary').style.display = 'none';
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì‹¤í–‰
        window.addEventListener('load', () => {
            runAllTests();
        });
    </script>
</body>
</html>
